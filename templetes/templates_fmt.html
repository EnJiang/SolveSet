<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>C:\Codes\templetes\templates_fmt.cpp</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta name="generator" content="Code::Blocks Exporter plugin" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.style11 { color: #000000; background-color: #FFFFFF; }
.style64 { color: #C8C8C8; }
.style72 { color: #C8C8C8; }
.style75 { color: #C8C8C8; }
.style1 { color: #A0A0A0; }
.style23 { color: #A0A0A0; }
.style65 { color: #A0A0A0; }
.style87 { color: #A0A0A0; }
.style2 { color: #BEBEE6; }
.style66 { color: #BEBEE6; }
.style3 { color: #8080FF; font-weight: bold; }
.style24 { color: #8080FF; font-weight: bold; }
.style67 { color: #8080FF; font-weight: bold; }
.style88 { color: #8080FF; font-weight: bold; }
.style15 { color: #8080FF; font-weight: bold; }
.style79 { color: #8080FF; font-weight: bold; }
.style17 { color: #008080; }
.style81 { color: #008080; }
.style18 { color: #800000; }
.style82 { color: #800000; }
.style4 { color: #F000F0; }
.style68 { color: #F0C8F0; }
.style5 { color: #0000A0; font-weight: bold; }
.style69 { color: #8787C8; font-weight: bold; }
.style16 { color: #00A000; font-weight: bold; }
.style80 { color: #9AC89A; font-weight: bold; }
.style19 { color: #BE00BE; font-weight: bold; }
.style83 { color: #BE89BE; font-weight: bold; }
.style6 { color: #0000FF; }
.style12 { color: #0000FF; }
.style20 { color: #0000FF; }
.style70 { color: #BEBEFF; }
.style76 { color: #BEBEFF; }
.style7 { color: #E0A000; }
.style71 { color: #E0CE9F; }
.style8 { color: #000000; }
.style9 { color: #00A000; }
.style73 { color: #84A084; }
.style10 { color: #FF0000; }
.style74 { color: #FFC8C8; }
.style34 { color: #000000; background-color: #80FFFF; font-weight: bold; }
.style35 { color: #FFFFFF; background-color: #FF0000; font-weight: bold; }
.style50 { color: #404080; font-style: italic; }
.style114 { color: #8585AC; font-style: italic; }
--></style></head>
<body>
<pre>
<code><span style="font: 8pt Courier New;"><span class="body">
</span><span class="style11">双连通分量
</span><span class="style5">int </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">iscur</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">bccno</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">dfs_clock</span><span class="style10">, </span><span class="style11">bcc_cnt</span><span class="style10">;
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">], </span><span class="style11">bcc</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];

</span><span class="style16">stack</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">s</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dfs</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">fa</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">lowu </span><span class="style10">= </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">dfs_clock</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">child </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0 </span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">size</span><span class="style10">();</span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">int </span><span class="style11">v</span><span class="style10">= </span><span class="style11">G</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        </span><span class="style11">edge e </span><span class="style10">= (</span><span class="style11">edge</span><span class="style10">) {</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">};
        </span><span class="style5">if</span><span class="style10">(!</span><span class="style11">pre</span><span class="style10">[</span><span class="style11">v</span><span class="style10">])
        {
            </span><span class="style11">s</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">e</span><span class="style10">);
            </span><span class="style11">child</span><span class="style10">++;
            </span><span class="style5">int </span><span class="style11">lowv </span><span class="style10">= </span><span class="style11">dfs</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);
            </span><span class="style11">lowu </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">lowu</span><span class="style10">, </span><span class="style11">lowv</span><span class="style10">);
            </span><span class="style5">if</span><span class="style10">(</span><span class="style11">lowv </span><span class="style10">&gt;= </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">])
            {
                </span><span class="style11">iscut</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
                </span><span class="style11">bcc_cnt</span><span class="style10">++;
                </span><span class="style11">bcc</span><span class="style10">[</span><span class="style11">bcc_cnt</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
                </span><span class="style5">for</span><span class="style10">(;;)
                {
                    </span><span class="style11">edge x </span><span class="style10">= </span><span class="style11">s</span><span class="style10">.</span><span class="style11">top</span><span class="style10">(); </span><span class="style11">s</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
                    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">bccno</span><span class="style10">[</span><span class="style11">x</span><span class="style10">.</span><span class="style11">u</span><span class="style10">] != </span><span class="style11">bcc_cnt</span><span class="style10">)
                    {
                        </span><span class="style11">bcc</span><span class="style10">[</span><span class="style11">bcc_cnt</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">u</span><span class="style10">);
                        </span><span class="style11">bccno</span><span class="style10">[</span><span class="style11">x</span><span class="style10">.</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">bcc_cnt</span><span class="style10">;
                    }
                    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">bccno</span><span class="style10">[</span><span class="style11">x</span><span class="style10">.</span><span class="style11">v</span><span class="style10">] != </span><span class="style11">bcc_cnt</span><span class="style10">)
                    {
                        </span><span class="style11">bcc</span><span class="style10">[</span><span class="style11">bcc_cnt</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">v</span><span class="style10">);
                        </span><span class="style11">bccno</span><span class="style10">[</span><span class="style11">x</span><span class="style10">.</span><span class="style11">v</span><span class="style10">] = </span><span class="style11">bcc_cnt</span><span class="style10">;
                    }
                    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">x</span><span class="style10">.</span><span class="style11">u </span><span class="style10">== </span><span class="style11">u </span><span class="style10">&amp;&amp; </span><span class="style11">x</span><span class="style10">.</span><span class="style11">v </span><span class="style10">== </span><span class="style11">v</span><span class="style10">)
                    {
                        </span><span class="style5">break</span><span class="style10">;
                    }
                }
            }
            </span><span class="style5">else if</span><span class="style10">(</span><span class="style11">pre</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &lt; </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &amp;&amp; </span><span class="style11">v </span><span class="style10">!= </span><span class="style11">fa</span><span class="style10">)
            {
                </span><span class="style11">S</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">e</span><span class="style10">);
                </span><span class="style11">lowu </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">lowu</span><span class="style10">, </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">v</span><span class="style10">]);
            }
        }
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">fa </span><span class="style10">&lt; </span><span class="style4">0 </span><span class="style10">&amp;&amp; </span><span class="style11">child </span><span class="style10">== </span><span class="style4">1</span><span class="style10">)
        {
            </span><span class="style11">iscut</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        }
    }
    </span><span class="style5">return </span><span class="style11">lowu</span><span class="style10">;
}
</span><span class="style5">void </span><span class="style11">find_bcc</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">)
{
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">pre</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">pre</span><span class="style10">));
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">iscut</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">iscut</span><span class="style10">));
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">bccno</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">bccno</span><span class="style10">));
    </span><span class="style11">dfs_clock </span><span class="style10">= </span><span class="style11">bcc_cnt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">if</span><span class="style10">(!</span><span class="style11">pre</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]) </span><span class="style11">dfs</span><span class="style10">(</span><span class="style11">i</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">);
    }
}

</span><span class="style11">树状数组BIT

</span><span class="style9">#include&lt;cstdio&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">10000</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">n</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">C</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">lsb</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">)
{
    </span><span class="style5">return </span><span class="style11">x</span><span class="style10">&amp;(-</span><span class="style11">x</span><span class="style10">);
}
</span><span class="style5">int </span><span class="style11">sum</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">ret </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">x </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">)
    {
        </span><span class="style11">ret </span><span class="style10">+= </span><span class="style11">C</span><span class="style10">[</span><span class="style11">x</span><span class="style10">];
        </span><span class="style11">x</span><span class="style10">-=</span><span class="style11">lsb</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
    </span><span class="style5">return </span><span class="style11">ret</span><span class="style10">;
}
</span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">, </span><span class="style5">int </span><span class="style11">d</span><span class="style10">)
{
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">x </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">)
    {
        </span><span class="style11">C</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] += </span><span class="style11">d</span><span class="style10">;
        </span><span class="style11">x </span><span class="style10">+= </span><span class="style11">lsb</span><span class="style10">(</span><span class="style11">x</span><span class="style10">);
    }
}
</span><span class="style1">/* ***********************************************
Author        :kuangbin
横纵坐标都从1开始
外部调用dance(0)
ansd为ans数组的size
ans数组存了答案

************************************************ */
</span><span class="style9">#define _CRT_SECURE_NO_WARNINGS
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;set&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;math.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxnode </span><span class="style10">= </span><span class="style4">100010</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MaxM </span><span class="style10">= </span><span class="style4">1010</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MaxN </span><span class="style10">= </span><span class="style4">1010</span><span class="style10">;
</span><span class="style2">//精确覆盖
</span><span class="style5">struct </span><span class="style11">DLX
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style16">size</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">U</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">],</span><span class="style11">D</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">],</span><span class="style11">R</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">],</span><span class="style11">L</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">],</span><span class="style11">Row</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">],</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">H</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">], </span><span class="style11">S</span><span class="style10">[</span><span class="style11">MaxM</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">ansd</span><span class="style10">, </span><span class="style11">ans</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">];
    </span><span class="style5">void </span><span class="style11">init</span><span class="style10">(</span><span class="style5">int </span><span class="style11">_n</span><span class="style10">,</span><span class="style5">int </span><span class="style11">_m</span><span class="style10">)
    {
        </span><span class="style11">n </span><span class="style10">= </span><span class="style11">_n</span><span class="style10">;
        </span><span class="style11">m </span><span class="style10">= </span><span class="style11">_m</span><span class="style10">;
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;</span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">;</span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
            </span><span class="style11">U</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">+</span><span class="style4">1</span><span class="style10">;
        }
        </span><span class="style11">R</span><span class="style10">[</span><span class="style11">m</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">; </span><span class="style11">L</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">m</span><span class="style10">;
        </span><span class="style16">size </span><span class="style10">= </span><span class="style11">m</span><span class="style10">;
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;</span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">;</span><span class="style11">i</span><span class="style10">++)
            </span><span class="style11">H</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style5">void </span><span class="style11">Link</span><span class="style10">(</span><span class="style5">int </span><span class="style11">r</span><span class="style10">,</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        ++</span><span class="style11">S</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[++</span><span class="style16">size</span><span class="style10">]=</span><span class="style11">c</span><span class="style10">];
        </span><span class="style11">Row</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">r</span><span class="style10">;
        </span><span class="style11">D</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];
        </span><span class="style11">U</span><span class="style10">[</span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style11">U</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">;
        </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] &lt; </span><span class="style4">0</span><span class="style10">)</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">R</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style5">else
        </span><span class="style10">{
            </span><span class="style11">R</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">R</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]];
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]]] = </span><span class="style16">size</span><span class="style10">;
            </span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
        }
    }
    </span><span class="style5">void </span><span class="style16">remove</span><span class="style10">(</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];</span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">;</span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
            </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];</span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">;</span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
            {
                </span><span class="style11">U</span><span class="style10">[</span><span class="style11">D</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]] = </span><span class="style11">U</span><span class="style10">[</span><span class="style11">j</span><span class="style10">];
                </span><span class="style11">D</span><span class="style10">[</span><span class="style11">U</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]] = </span><span class="style11">D</span><span class="style10">[</span><span class="style11">j</span><span class="style10">];
                --</span><span class="style11">S</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]];
            }
    }
    </span><span class="style5">void </span><span class="style11">resume</span><span class="style10">(</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];</span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">;</span><span class="style11">i </span><span class="style10">= </span><span class="style11">U</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
            </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];</span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">;</span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
                ++</span><span class="style11">S</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">U</span><span class="style10">[</span><span class="style11">D</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]]=</span><span class="style11">D</span><span class="style10">[</span><span class="style11">U</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]]=</span><span class="style11">j</span><span class="style10">]];
        </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style11">c</span><span class="style10">;
    }
    </span><span class="style2">//d为递归深度
    </span><span class="style5">bool </span><span class="style11">Dance</span><span class="style10">(</span><span class="style5">int </span><span class="style11">d</span><span class="style10">)
    {
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">)
        {
            </span><span class="style11">ansd </span><span class="style10">= </span><span class="style11">d</span><span class="style10">;
            </span><span class="style5">return true</span><span class="style10">;
        }
        </span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">];
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">];</span><span class="style11">i </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">;</span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
            </span><span class="style5">if</span><span class="style10">(</span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">S</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
                </span><span class="style11">c </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
        </span><span class="style16">remove</span><span class="style10">(</span><span class="style11">c</span><span class="style10">);
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];</span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">;</span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style11">ans</span><span class="style10">[</span><span class="style11">d</span><span class="style10">] = </span><span class="style11">Row</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
            </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">;</span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])</span><span class="style16">remove</span><span class="style10">(</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]);
            </span><span class="style5">if</span><span class="style10">(</span><span class="style11">Dance</span><span class="style10">(</span><span class="style11">d</span><span class="style10">+</span><span class="style4">1</span><span class="style10">))</span><span class="style5">return true</span><span class="style10">;
            </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">;</span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])</span><span class="style11">resume</span><span class="style10">(</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]);
        }
        </span><span class="style11">resume</span><span class="style10">(</span><span class="style11">c</span><span class="style10">);
        </span><span class="style5">return false</span><span class="style10">;
    }
};

</span><span class="style11">DLX g</span><span class="style10">;




















</span><span class="style2">//重复覆盖
//K为最大递归深度
</span><span class="style1">/* ***********************************************
Author        :kuangbin
横纵坐标都从1开始
外部调用dance(0)
ansd为ans数组的size
ans数组存了答案
************************************************ */
</span><span class="style9">#define _CRT_SECURE_NO_WARNINGS
#include &lt;stdio.h&gt;
#include&lt;functional&gt;
#include &lt;string.h&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;set&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;math.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">inf </span><span class="style10">= </span><span class="style4">0x3f3f3f3f</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxnode </span><span class="style10">= </span><span class="style4">100010</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1010</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MaxN </span><span class="style10">= </span><span class="style4">1010</span><span class="style10">;

</span><span class="style5">struct </span><span class="style11">DLX
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">, </span><span class="style11">m</span><span class="style10">, </span><span class="style16">size</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">U</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">D</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">R</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">L</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">Row</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">Col</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">H</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">], </span><span class="style11">S</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">ansd</span><span class="style10">, </span><span class="style11">ans</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">K</span><span class="style10">;
    </span><span class="style5">void </span><span class="style11">init</span><span class="style10">(</span><span class="style5">int </span><span class="style11">_n</span><span class="style10">, </span><span class="style5">int </span><span class="style11">_m</span><span class="style10">)
    {
        </span><span class="style11">n </span><span class="style10">= </span><span class="style11">_n</span><span class="style10">;
        </span><span class="style11">m </span><span class="style10">= </span><span class="style11">_m</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">U</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        }
        </span><span class="style11">R</span><span class="style10">[</span><span class="style11">m</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">L</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">m</span><span class="style10">;
        </span><span class="style16">size </span><span class="style10">= </span><span class="style11">m</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">H</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
        }

    }
    </span><span class="style5">void </span><span class="style11">Link</span><span class="style10">(</span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style11">S</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[++</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">]++;
        </span><span class="style11">Row</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">r</span><span class="style10">;
        </span><span class="style11">U</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];
        </span><span class="style11">D</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">;
        </span><span class="style11">D</span><span class="style10">[</span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] == -</span><span class="style4">1</span><span class="style10">)
        {
            </span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">R</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style16">size</span><span class="style10">;
        }
        </span><span class="style5">else
        </span><span class="style10">{
            </span><span class="style11">R</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
            </span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]];
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
        }
    }
    </span><span class="style5">void </span><span class="style16">remove</span><span class="style10">(</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        }
    }
    </span><span class="style5">void </span><span class="style11">resume</span><span class="style10">(</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">U</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">i</span><span class="style10">;
        }
    }
    </span><span class="style5">bool </span><span class="style11">v</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">h</span><span class="style10">()
    {
        </span><span class="style5">int </span><span class="style11">ret </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">c </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]) </span><span class="style11">v</span><span class="style10">[</span><span class="style11">c</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">c </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
            {
                </span><span class="style11">ret</span><span class="style10">++;
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
                {
                    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
                    {
                        </span><span class="style11">v</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]] = </span><span class="style5">false</span><span class="style10">;
                    }
                }
            }
        }
        </span><span class="style5">return </span><span class="style11">ret</span><span class="style10">;
    }
    </span><span class="style5">bool </span><span class="style11">dance</span><span class="style10">(</span><span class="style5">int </span><span class="style11">d</span><span class="style10">)
    {
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">+ </span><span class="style11">h</span><span class="style10">() &gt; </span><span class="style11">K</span><span class="style10">)
        {
            </span><span class="style5">return false</span><span class="style10">;
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">)
        {
            </span><span class="style5">return </span><span class="style11">d </span><span class="style10">&lt;= </span><span class="style11">K</span><span class="style10">;
        }
        </span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">];
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">S</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
            {
                </span><span class="style11">c </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
            }
        }
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
            {
                </span><span class="style16">remove</span><span class="style10">(</span><span class="style11">j</span><span class="style10">);
            }
            </span><span class="style16">remove</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dance</span><span class="style10">(</span><span class="style11">d </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">)) </span><span class="style5">return true</span><span class="style10">;
            </span><span class="style11">resume</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
            {
                </span><span class="style11">resume</span><span class="style10">(</span><span class="style11">j</span><span class="style10">);
            }
        }
        </span><span class="style5">return false</span><span class="style10">;
    }
};

</span><span class="style11">DLX gg</span><span class="style10">;




























</span><span class="style2">//重复覆盖
//K为最大递归深度
</span><span class="style1">/* ***********************************************
Author        :kuangbin
横纵坐标都从1开始
外部调用dance(0)
ansd为ans数组的size
ans数组存了答案
*************************************************/
</span><span class="style9">#define _CRT_SECURE_NO_WARNINGS
#include &lt;stdio.h&gt;
#include&lt;functional&gt;
#include &lt;string.h&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;vector&gt;
#include &lt;queue&gt;
#include &lt;set&gt;
#include &lt;map&gt;
#include &lt;string&gt;
#include &lt;math.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;time.h&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">inf </span><span class="style10">= </span><span class="style4">0x3f3f3f3f</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxnode </span><span class="style10">= </span><span class="style4">100010</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">1010</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MaxN </span><span class="style10">= </span><span class="style4">1010</span><span class="style10">;

</span><span class="style5">struct </span><span class="style11">DLX
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">, </span><span class="style11">m</span><span class="style10">, </span><span class="style16">size</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">U</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">D</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">R</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">L</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">Row</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">], </span><span class="style11">Col</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">H</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">], </span><span class="style11">S</span><span class="style10">[</span><span class="style11">MaxN</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">ansd</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">K</span><span class="style10">;
    </span><span class="style5">void </span><span class="style11">init</span><span class="style10">(</span><span class="style5">int </span><span class="style11">_n</span><span class="style10">, </span><span class="style5">int </span><span class="style11">_m</span><span class="style10">)
    {
        </span><span class="style11">n </span><span class="style10">= </span><span class="style11">_n</span><span class="style10">;
        </span><span class="style11">ansd </span><span class="style10">= </span><span class="style11">inf</span><span class="style10">;
        </span><span class="style11">m </span><span class="style10">= </span><span class="style11">_m</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">U</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
            </span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        }
        </span><span class="style11">R</span><span class="style10">[</span><span class="style11">m</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">L</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">m</span><span class="style10">;
        </span><span class="style16">size </span><span class="style10">= </span><span class="style11">m</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">H</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
        }

    }
    </span><span class="style5">void </span><span class="style11">Link</span><span class="style10">(</span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style11">S</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[++</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">]++;
        </span><span class="style11">Row</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">r</span><span class="style10">;
        </span><span class="style11">U</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">];
        </span><span class="style11">D</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">c</span><span class="style10">;
        </span><span class="style11">D</span><span class="style10">[</span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">] = </span><span class="style16">size</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] == -</span><span class="style4">1</span><span class="style10">)
        {
            </span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">] = </span><span class="style11">R</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style16">size</span><span class="style10">;
        }
        </span><span class="style5">else
        </span><span class="style10">{
            </span><span class="style11">R</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">];
            </span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]];
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style16">size</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">H</span><span class="style10">[</span><span class="style11">r</span><span class="style10">]] = </span><span class="style16">size</span><span class="style10">;
        }
    }
    </span><span class="style5">void </span><span class="style16">remove</span><span class="style10">(</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];
        }
    }
    </span><span class="style5">void </span><span class="style11">resume</span><span class="style10">(</span><span class="style5">int </span><span class="style11">c</span><span class="style10">)
    {
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">U</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">U</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style11">R</span><span class="style10">[</span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">L</span><span class="style10">[</span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]] = </span><span class="style11">i</span><span class="style10">;
        }
    }
    </span><span class="style5">bool </span><span class="style11">v</span><span class="style10">[</span><span class="style11">maxnode</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">h</span><span class="style10">()
    {
        </span><span class="style5">int </span><span class="style11">ret </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">c </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]) </span><span class="style11">v</span><span class="style10">[</span><span class="style11">c</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">c </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">v</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
            {
                </span><span class="style11">ret</span><span class="style10">++;
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
                {
                    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
                    {
                        </span><span class="style11">v</span><span class="style10">[</span><span class="style11">Col</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]] = </span><span class="style5">false</span><span class="style10">;
                    }
                }
            }
        }
        </span><span class="style5">return </span><span class="style11">ret</span><span class="style10">;
    }
    </span><span class="style5">bool </span><span class="style11">dance</span><span class="style10">(</span><span class="style5">int </span><span class="style11">d</span><span class="style10">)
    {
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">+ </span><span class="style11">h</span><span class="style10">() &gt; </span><span class="style11">ansd</span><span class="style10">)
        {
            </span><span class="style5">return false</span><span class="style10">;
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">)
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">ansd </span><span class="style10">&gt; </span><span class="style11">d</span><span class="style10">) </span><span class="style11">ansd </span><span class="style10">= </span><span class="style11">d</span><span class="style10">;
            </span><span class="style5">return true</span><span class="style10">;
        }
        </span><span class="style5">bool </span><span class="style11">ret </span><span class="style10">= </span><span class="style5">false</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">];
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">S</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
            {
                </span><span class="style11">c </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
            }
        }
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style16">remove</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
            {
                </span><span class="style16">remove</span><span class="style10">(</span><span class="style11">j</span><span class="style10">);
            }
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dance</span><span class="style10">(</span><span class="style11">d </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">)) </span><span class="style11">ret </span><span class="style10">= </span><span class="style5">true</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
            {
                </span><span class="style11">resume</span><span class="style10">(</span><span class="style11">j</span><span class="style10">);
            }
            </span><span class="style11">resume</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
        </span><span class="style5">return </span><span class="style11">ret</span><span class="style10">;
    }
    </span><span class="style5">void </span><span class="style11">Dance</span><span class="style10">(</span><span class="style5">int </span><span class="style11">d</span><span class="style10">)
    {
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">+ </span><span class="style11">h</span><span class="style10">() &gt;= </span><span class="style11">ansd</span><span class="style10">)</span><span class="style5">return</span><span class="style10">;
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] == </span><span class="style4">0</span><span class="style10">)
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">d </span><span class="style10">&lt; </span><span class="style11">ansd</span><span class="style10">)</span><span class="style11">ansd </span><span class="style10">= </span><span class="style11">d</span><span class="style10">;
            </span><span class="style5">return</span><span class="style10">;
        }
        </span><span class="style5">int </span><span class="style11">c </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">];
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style4">0</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">S</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] &lt; </span><span class="style11">S</span><span class="style10">[</span><span class="style11">c</span><span class="style10">])
                </span><span class="style11">c </span><span class="style10">= </span><span class="style11">i</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">c</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">!= </span><span class="style11">c</span><span class="style10">; </span><span class="style11">i </span><span class="style10">= </span><span class="style11">D</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style16">remove</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">R</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])</span><span class="style16">remove</span><span class="style10">(</span><span class="style11">j</span><span class="style10">);
            </span><span class="style11">Dance</span><span class="style10">(</span><span class="style11">d </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">);
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]; </span><span class="style11">j </span><span class="style10">!= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">= </span><span class="style11">L</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])</span><span class="style11">resume</span><span class="style10">(</span><span class="style11">j</span><span class="style10">);
            </span><span class="style11">resume</span><span class="style10">(</span><span class="style11">i</span><span class="style10">);
        }
    }
};

</span><span class="style11">DLX gg</span><span class="style10">;

</span><span class="style11">dijkstra最短路

</span><span class="style9">#include&lt;iostream&gt;
#include&lt;vector&gt;
#include&lt;cstring&gt;
#include&lt;functional&gt;
#include&lt;algorithm&gt;
#include&lt;string&gt;
#include&lt;queue&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">typedef </span><span class="style16">pair</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">, </span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">pii</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">10005</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">const int </span><span class="style11">inf </span><span class="style10">= </span><span class="style4">0x3f3f3f3f</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">ecnt</span><span class="style10">;
</span><span class="style5">struct </span><span class="style11">edge
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">from</span><span class="style10">, </span><span class="style11">to</span><span class="style10">, </span><span class="style11">cost</span><span class="style10">;
};
</span><span class="style11">edge es</span><span class="style10">[</span><span class="style11">maxn </span><span class="style10">* </span><span class="style11">maxn</span><span class="style10">];

</span><span class="style5">void </span><span class="style11">dijkstra</span><span class="style10">(</span><span class="style5">int </span><span class="style11">s</span><span class="style10">)
{
    </span><span class="style16">priority_queue</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">, </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt;, </span><span class="style16">greater</span><span class="style10">&lt;</span><span class="style11">pii</span><span class="style10">&gt; &gt; </span><span class="style11">q</span><span class="style10">;
    </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style4">0</span><span class="style10">, </span><span class="style11">s</span><span class="style10">});
    </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">s</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">())
    {
        </span><span class="style11">pii c </span><span class="style10">= </span><span class="style11">q</span><span class="style10">.</span><span class="style11">top</span><span class="style10">();
        </span><span class="style11">q</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
        </span><span class="style5">int </span><span class="style11">cur </span><span class="style10">= </span><span class="style11">c</span><span class="style10">.</span><span class="style11">second</span><span class="style10">;

        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">cur</span><span class="style10">].</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">edge </span><span class="style10">&amp; </span><span class="style11">e </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">G</span><span class="style10">[</span><span class="style11">cur</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]];
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">] &gt; </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">] + </span><span class="style11">e</span><span class="style10">.</span><span class="style11">cost</span><span class="style10">)
            {
                </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">] = </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">] + </span><span class="style11">e</span><span class="style10">.</span><span class="style11">cost</span><span class="style10">;
                </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">({</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">],</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">});
            }
        }

    }
}
</span><span class="style5">void </span><span class="style11">init</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)
{
    </span><span class="style11">ecnt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style11">G</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
    }
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">dis</span><span class="style10">, </span><span class="style11">inf</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">dis</span><span class="style10">));
}
</span><span class="style5">void </span><span class="style11">addedge</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">, </span><span class="style5">int </span><span class="style11">w</span><span class="style10">)
{
    </span><span class="style11">es</span><span class="style10">[</span><span class="style11">ecnt</span><span class="style10">] = {</span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">};
    </span><span class="style11">G</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">ecnt</span><span class="style10">++);
}

</span><span class="style11">并查集
</span><span class="style9">#include&lt;cstdio&gt;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100000 </span><span class="style10">+ </span><span class="style4">10</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">pa</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style16">rank</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">findset</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">)
{
    </span><span class="style5">return </span><span class="style11">pa</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]!=</span><span class="style11">x </span><span class="style10">? </span><span class="style11">pa</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">findset</span><span class="style10">(</span><span class="style11">pa</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]) : </span><span class="style11">x</span><span class="style10">;
}
</span><span class="style5">void </span><span class="style11">uni</span><span class="style10">(</span><span class="style5">int </span><span class="style11">a</span><span class="style10">, </span><span class="style5">int </span><span class="style11">b</span><span class="style10">)
{
    </span><span class="style5">if</span><span class="style10">((</span><span class="style11">a </span><span class="style10">= </span><span class="style11">findset</span><span class="style10">(</span><span class="style11">a</span><span class="style10">)) == (</span><span class="style11">b </span><span class="style10">= </span><span class="style11">findset</span><span class="style10">(</span><span class="style11">b</span><span class="style10">)))
    {
        </span><span class="style5">return</span><span class="style10">;
    }
    </span><span class="style5">if</span><span class="style10">(</span><span class="style16">rank</span><span class="style10">[</span><span class="style11">a</span><span class="style10">] &gt; </span><span class="style16">rank</span><span class="style10">[</span><span class="style11">b</span><span class="style10">])
    {
        </span><span class="style11">pa</span><span class="style10">[</span><span class="style11">b</span><span class="style10">] = </span><span class="style11">a</span><span class="style10">;
    }
    </span><span class="style5">else
    </span><span class="style10">{
        </span><span class="style5">if</span><span class="style10">(</span><span class="style16">rank</span><span class="style10">[</span><span class="style11">a</span><span class="style10">] == </span><span class="style16">rank</span><span class="style10">[</span><span class="style11">b</span><span class="style10">])
            </span><span class="style16">rank</span><span class="style10">[</span><span class="style11">b</span><span class="style10">] ++;
        </span><span class="style11">pa</span><span class="style10">[</span><span class="style11">a</span><span class="style10">] = </span><span class="style11">b</span><span class="style10">;
    }
}
</span><span class="style5">void </span><span class="style11">initps</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)
{
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style11">pa</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
        </span><span class="style16">rank</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    }
}
</span><span class="style11">欧拉phi函数：小于n且与n互素的整数个数

</span><span class="style5">int </span><span class="style11">euler_phi</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">m </span><span class="style10">= (</span><span class="style5">int</span><span class="style10">) </span><span class="style11">sqrt</span><span class="style10">(</span><span class="style11">n </span><span class="style10">+</span><span class="style4">0.5</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">ans </span><span class="style10">= </span><span class="style11">n</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style11">i </span><span class="style10">== </span><span class="style4">0</span><span class="style10">)
        {
            </span><span class="style11">ans </span><span class="style10">= </span><span class="style11">ans </span><span class="style10">/ </span><span class="style11">i </span><span class="style10">* (</span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">);
            </span><span class="style5">while</span><span class="style10">(</span><span class="style11">n </span><span class="style10">% </span><span class="style11">i </span><span class="style10">== </span><span class="style4">0</span><span class="style10">)
            {
                </span><span class="style11">n </span><span class="style10">/= </span><span class="style11">i</span><span class="style10">;
            }
        }
    }
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">n </span><span class="style10">&gt; </span><span class="style4">1</span><span class="style10">)
    {
        </span><span class="style11">ans </span><span class="style10">= </span><span class="style11">ans </span><span class="style10">/ </span><span class="style11">n </span><span class="style10">* (</span><span class="style11">n </span><span class="style10">- </span><span class="style4">1</span><span class="style10">);
    }
}
</span><span class="style5">int </span><span class="style11">phi</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">void </span><span class="style11">phi_table</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)
{
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style11">phi</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    }
    </span><span class="style11">phi</span><span class="style10">[</span><span class="style4">1</span><span class="style10">] = </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">2</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">if</span><span class="style10">(!</span><span class="style11">phi</span><span class="style10">[</span><span class="style11">i</span><span class="style10">])
        {
            </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style11">i</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">+= </span><span class="style11">i</span><span class="style10">)
            {
                </span><span class="style5">if</span><span class="style10">(!</span><span class="style11">phi</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
                {
                    </span><span class="style11">phi</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">j</span><span class="style10">;
                }
                </span><span class="style11">phi</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">phi</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] / </span><span class="style11">i </span><span class="style10">* (</span><span class="style11">i </span><span class="style10">- </span><span class="style4">1</span><span class="style10">);
            }
        }
    }
}


</span><span class="style11">iscut寻找割

</span><span class="style5">int </span><span class="style11">dfs_clock</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dfs</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">fa</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">lowu </span><span class="style10">= </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = ++</span><span class="style11">dfs_clock</span><span class="style10">;</span><span class="style2">//
    </span><span class="style5">int </span><span class="style11">child </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">G</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
        </span><span class="style5">if</span><span class="style10">(!</span><span class="style11">pre</span><span class="style10">[</span><span class="style11">v</span><span class="style10">])</span><span class="style2">//have not been visited
        </span><span class="style10">{
            </span><span class="style11">child</span><span class="style10">++;
            </span><span class="style5">int </span><span class="style11">lowv </span><span class="style10">= </span><span class="style11">dfs</span><span class="style10">(</span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">);
            </span><span class="style11">lowu </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">lowu</span><span class="style10">, </span><span class="style11">lowv</span><span class="style10">);
            </span><span class="style5">if</span><span class="style10">(</span><span class="style11">lowv </span><span class="style10">&gt;= </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">])
            {
                </span><span class="style11">iscut</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
            }
        }
        </span><span class="style5">else if</span><span class="style10">(</span><span class="style11">pre</span><span class="style10">[</span><span class="style11">v</span><span class="style10">] &lt; </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] &amp;&amp; </span><span class="style11">v </span><span class="style10">!= </span><span class="style11">fa</span><span class="style10">)
        {
            </span><span class="style11">lowu </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">lowu</span><span class="style10">, </span><span class="style11">pre</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]);
        }
    }
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">fa </span><span class="style10">&lt; </span><span class="style4">0 </span><span class="style10">&amp;&amp; </span><span class="style11">child </span><span class="style10">== </span><span class="style4">1</span><span class="style10">)
    {
        </span><span class="style11">iscut</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
    }
    </span><span class="style11">low</span><span class="style10">[</span><span class="style11">u</span><span class="style10">] = </span><span class="style11">lowu</span><span class="style10">;
    </span><span class="style5">return </span><span class="style11">lowu</span><span class="style10">;
}


</span><span class="style1">/*
* Kruskal算法求MST
*/
</span><span class="style9">#include&lt;iostream&gt;
#include&lt;cstring&gt;
#include&lt;algorithm&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MAXN </span><span class="style10">= </span><span class="style4">110</span><span class="style10">;</span><span class="style2">//最大点数
</span><span class="style5">const int </span><span class="style11">MAXM </span><span class="style10">= </span><span class="style4">10000</span><span class="style10">;</span><span class="style2">//最大边数
</span><span class="style5">int </span><span class="style11">F</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">];</span><span class="style2">//并查集使用
</span><span class="style5">struct </span><span class="style11">Edge
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style11">w</span><span class="style10">;
}</span><span class="style11">edge</span><span class="style10">[</span><span class="style11">MAXM</span><span class="style10">];</span><span class="style2">//存储边的信息，包括起点/终点/权值
</span><span class="style5">int </span><span class="style11">tol</span><span class="style10">;</span><span class="style2">//边数，加边前赋值为0
</span><span class="style5">void </span><span class="style11">addedge</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">, </span><span class="style5">int </span><span class="style11">w</span><span class="style10">)
{

    </span><span class="style11">edge</span><span class="style10">[</span><span class="style11">tol</span><span class="style10">].</span><span class="style11">u </span><span class="style10">= </span><span class="style11">u</span><span class="style10">;
    </span><span class="style11">edge</span><span class="style10">[</span><span class="style11">tol</span><span class="style10">].</span><span class="style11">v </span><span class="style10">= </span><span class="style11">v</span><span class="style10">;
    </span><span class="style11">edge</span><span class="style10">[</span><span class="style11">tol</span><span class="style10">++].</span><span class="style11">w </span><span class="style10">= </span><span class="style11">w</span><span class="style10">;
}
</span><span class="style5">bool </span><span class="style11">cmp</span><span class="style10">(</span><span class="style11">Edge a</span><span class="style10">, </span><span class="style11">Edge b</span><span class="style10">)
{</span><span class="style2">//排序函数，讲边按照权值从小到大排序
    </span><span class="style5">return </span><span class="style11">a</span><span class="style10">.</span><span class="style11">w</span><span class="style10">&lt;</span><span class="style11">b</span><span class="style10">.</span><span class="style11">w</span><span class="style10">;
}
</span><span class="style5">int </span><span class="style16">find</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">)
{
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">F</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] == -</span><span class="style4">1</span><span class="style10">)</span><span class="style5">return </span><span class="style11">x</span><span class="style10">;
    </span><span class="style5">else return </span><span class="style11">F</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style16">find</span><span class="style10">(</span><span class="style11">F</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]);
}
</span><span class="style5">int </span><span class="style11">Kruskal</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)</span><span class="style2">//传入点数，返回最小生成树的权值，如果不连通返回-1
</span><span class="style10">{
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">F</span><span class="style10">, -</span><span class="style4">1</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">F</span><span class="style10">));
    </span><span class="style16">sort</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">, </span><span class="style11">edge </span><span class="style10">+ </span><span class="style11">tol</span><span class="style10">, </span><span class="style11">cmp</span><span class="style10">);
    </span><span class="style5">int </span><span class="style11">cnt </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;</span><span class="style2">//计算加入的边数
    </span><span class="style5">int </span><span class="style11">ans </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i</span><span class="style10">&lt;</span><span class="style11">tol</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">int </span><span class="style11">u </span><span class="style10">= </span><span class="style11">edge</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">u</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">v </span><span class="style10">= </span><span class="style11">edge</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">v</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">w </span><span class="style10">= </span><span class="style11">edge</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style11">w</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">t1 </span><span class="style10">= </span><span class="style16">find</span><span class="style10">(</span><span class="style11">u</span><span class="style10">);
        </span><span class="style5">int </span><span class="style11">t2 </span><span class="style10">= </span><span class="style16">find</span><span class="style10">(</span><span class="style11">v</span><span class="style10">);
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">t1 </span><span class="style10">!= </span><span class="style11">t2</span><span class="style10">)
        {
            </span><span class="style11">ans </span><span class="style10">+= </span><span class="style11">w</span><span class="style10">;
            </span><span class="style11">F</span><span class="style10">[</span><span class="style11">t1</span><span class="style10">] = </span><span class="style11">t2</span><span class="style10">;
            </span><span class="style11">cnt</span><span class="style10">++;
        }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">cnt </span><span class="style10">== </span><span class="style11">n </span><span class="style10">- </span><span class="style4">1</span><span class="style10">)</span><span class="style5">break</span><span class="style10">;
    }
    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">cnt</span><span class="style10">&lt;</span><span class="style11">n </span><span class="style10">- </span><span class="style4">1</span><span class="style10">)</span><span class="style5">return </span><span class="style10">-</span><span class="style4">1</span><span class="style10">;</span><span class="style2">//不连通
    </span><span class="style5">else return </span><span class="style11">ans</span><span class="style10">;
}


</span><span class="style9">#include&lt;cstring&gt;
#include&lt;iostream&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;


</span><span class="style1">/*
* Prim求MST
* 耗费矩阵cost[][]，标号从0开始，0~n-1
* 返回最小生成树的权值，返回-1表示原图不连通
*/
</span><span class="style5">const int </span><span class="style11">INF </span><span class="style10">= </span><span class="style4">0x3f3f3f3f</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">MAXN </span><span class="style10">= </span><span class="style4">110</span><span class="style10">;
</span><span class="style5">bool </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">lowc</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">][</span><span class="style11">MAXN</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">Prim</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)</span><span class="style2">//点是0~n-1
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">ans </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
    </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">vis</span><span class="style10">, </span><span class="style5">false</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">vis</span><span class="style10">));
    </span><span class="style11">vis</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">&lt;</span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)</span><span class="style11">lowc</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">cost</span><span class="style10">[</span><span class="style4">0</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
    </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i</span><span class="style10">&lt;</span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style5">int </span><span class="style11">minc </span><span class="style10">= </span><span class="style11">INF</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">p </span><span class="style10">= -</span><span class="style4">1</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j</span><span class="style10">&lt;</span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++)
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">vis</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] &amp;&amp; </span><span class="style11">minc</span><span class="style10">&gt;</span><span class="style11">lowc</span><span class="style10">[</span><span class="style11">j</span><span class="style10">])
            {
                </span><span class="style11">minc </span><span class="style10">= </span><span class="style11">lowc</span><span class="style10">[</span><span class="style11">j</span><span class="style10">];
                </span><span class="style11">p </span><span class="style10">= </span><span class="style11">j</span><span class="style10">;
            }
        </span><span class="style5">if </span><span class="style10">(</span><span class="style11">minc </span><span class="style10">== </span><span class="style11">INF</span><span class="style10">)</span><span class="style5">return </span><span class="style10">-</span><span class="style4">1</span><span class="style10">;</span><span class="style2">//原图不连通
        </span><span class="style11">ans </span><span class="style10">+= </span><span class="style11">minc</span><span class="style10">;
        </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">p</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">j</span><span class="style10">&lt;</span><span class="style11">n</span><span class="style10">; </span><span class="style11">j</span><span class="style10">++)
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">vis</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] &amp;&amp; </span><span class="style11">lowc</span><span class="style10">[</span><span class="style11">j</span><span class="style10">]&gt;</span><span class="style11">cost</span><span class="style10">[</span><span class="style11">p</span><span class="style10">][</span><span class="style11">j</span><span class="style10">])
                </span><span class="style11">lowc</span><span class="style10">[</span><span class="style11">j</span><span class="style10">] = </span><span class="style11">cost</span><span class="style10">[</span><span class="style11">p</span><span class="style10">][</span><span class="style11">j</span><span class="style10">];
    }
    </span><span class="style5">return </span><span class="style11">ans</span><span class="style10">;
}


</span><span class="style11">最大流isap算法

</span><span class="style9">#include&lt;iostream&gt;
#include&lt;algorithm&gt;
#include&lt;vector&gt;
#include&lt;deque&gt;
#include&lt;cstring&gt;

</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">inf </span><span class="style10">= </span><span class="style4">0x3f3f3f3f</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxp </span><span class="style10">= </span><span class="style4">10</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">202 </span><span class="style10">* </span><span class="style4">2</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">S</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxp</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">Q</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">D</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">][</span><span class="style11">maxp</span><span class="style10">];
</span><span class="style5">struct </span><span class="style11">edge
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">from</span><span class="style10">, </span><span class="style11">to</span><span class="style10">, </span><span class="style11">flow</span><span class="style10">, </span><span class="style11">cap</span><span class="style10">;
};
</span><span class="style5">struct </span><span class="style11">isap
</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">, </span><span class="style11">m</span><span class="style10">, </span><span class="style11">s</span><span class="style10">, </span><span class="style11">t</span><span class="style10">;
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt; </span><span class="style11">es</span><span class="style10">;
    </span><span class="style5">bool </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">num</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">p</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
    </span><span class="style11">isap</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n_</span><span class="style10">) :</span><span class="style11">n</span><span class="style10">(</span><span class="style11">n_</span><span class="style10">)
    {

    }
    </span><span class="style5">void </span><span class="style11">add_edge</span><span class="style10">(</span><span class="style5">int </span><span class="style11">u</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">, </span><span class="style5">int </span><span class="style11">cap</span><span class="style10">)
    {
        </span><span class="style11">es</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">({ </span><span class="style11">u</span><span class="style10">, </span><span class="style11">v</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style11">cap </span><span class="style10">});
        </span><span class="style11">es</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">({ </span><span class="style11">v</span><span class="style10">, </span><span class="style11">u</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style4">0 </span><span class="style10">});
        </span><span class="style11">m </span><span class="style10">= </span><span class="style11">es</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
        </span><span class="style11">G</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">m </span><span class="style10">- </span><span class="style4">2</span><span class="style10">);
        </span><span class="style11">G</span><span class="style10">[</span><span class="style11">v</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">m </span><span class="style10">- </span><span class="style4">1</span><span class="style10">);

    }
    </span><span class="style5">void </span><span class="style11">bfs</span><span class="style10">()
    {
        </span><span class="style16">deque</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">q</span><span class="style10">;
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = </span><span class="style11">n</span><span class="style10">;
        }
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">vis</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">vis</span><span class="style10">));
        </span><span class="style11">q</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">t</span><span class="style10">);
        </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">t</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">t</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">())
        {
            </span><span class="style5">int </span><span class="style11">pos </span><span class="style10">= </span><span class="style11">q</span><span class="style10">.</span><span class="style16">front</span><span class="style10">();
            </span><span class="style11">q</span><span class="style10">.</span><span class="style16">pop_front</span><span class="style10">();

            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">].</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i</span><span class="style10">++)
            {
                </span><span class="style11">edge </span><span class="style10">&amp; </span><span class="style11">e </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">G</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">][</span><span class="style11">i</span><span class="style10">] ^ </span><span class="style4">1</span><span class="style10">];
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">cap </span><span class="style10">&gt; </span><span class="style11">e</span><span class="style10">.</span><span class="style11">flow </span><span class="style10">&amp;&amp; !</span><span class="style11">vis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">])
                {
                    </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">] = </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">pos</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">;
                    </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">] = </span><span class="style5">true</span><span class="style10">;
                    </span><span class="style11">q</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">);
                }
            }

        }

    }
    </span><span class="style5">int </span><span class="style11">aug</span><span class="style10">()
    {
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">t</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">a </span><span class="style10">= </span><span class="style11">inf</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">!= </span><span class="style11">s</span><span class="style10">)
        {
            </span><span class="style11">edge </span><span class="style10">&amp; </span><span class="style11">e </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]];
            </span><span class="style11">a </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">a</span><span class="style10">, </span><span class="style11">e</span><span class="style10">.</span><span class="style11">cap </span><span class="style10">- </span><span class="style11">e</span><span class="style10">.</span><span class="style11">flow</span><span class="style10">);
            </span><span class="style11">x </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">from</span><span class="style10">;
        }
        </span><span class="style11">x </span><span class="style10">= </span><span class="style11">t</span><span class="style10">;
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">!= </span><span class="style11">s</span><span class="style10">)
        {
            </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">flow </span><span class="style10">+= </span><span class="style11">a</span><span class="style10">;
            </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] ^ </span><span class="style4">1</span><span class="style10">].</span><span class="style11">flow </span><span class="style10">-= </span><span class="style11">a</span><span class="style10">;
            </span><span class="style11">x </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">from</span><span class="style10">;
        }
        </span><span class="style5">return </span><span class="style11">a</span><span class="style10">;
    }
    </span><span class="style5">int </span><span class="style11">maxflow</span><span class="style10">(</span><span class="style5">int </span><span class="style11">s</span><span class="style10">, </span><span class="style5">int </span><span class="style11">t</span><span class="style10">)
    {
        </span><span class="style5">int </span><span class="style11">flow </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">this</span><span class="style10">-&gt;</span><span class="style11">s </span><span class="style10">= </span><span class="style11">s</span><span class="style10">;
        </span><span class="style5">this</span><span class="style10">-&gt;</span><span class="style11">t </span><span class="style10">= </span><span class="style11">t</span><span class="style10">;
        </span><span class="style11">bfs</span><span class="style10">();
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">num</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">num</span><span class="style10">));
        </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">num</span><span class="style10">[</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">i</span><span class="style10">]]++;
        }
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">cur</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">cur</span><span class="style10">));
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">s</span><span class="style10">] &lt; </span><span class="style11">n</span><span class="style10">)
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x </span><span class="style10">== </span><span class="style11">t</span><span class="style10">)
            {
                </span><span class="style11">flow </span><span class="style10">+= </span><span class="style11">aug</span><span class="style10">();
                </span><span class="style11">x </span><span class="style10">= </span><span class="style11">s</span><span class="style10">;
            }
            </span><span class="style5">int </span><span class="style11">ok </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i</span><span class="style10">++)
            {
                </span><span class="style11">edge </span><span class="style10">&amp; </span><span class="style11">e </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]];
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">cap </span><span class="style10">&gt; </span><span class="style11">e</span><span class="style10">.</span><span class="style11">flow </span><span class="style10">&amp;&amp; </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] == </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">] + </span><span class="style4">1</span><span class="style10">)</span><span class="style2">//Advance
                </span><span class="style10">{
                    </span><span class="style11">ok </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
                    </span><span class="style11">p</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">] = </span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
                    </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
                    </span><span class="style11">x </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">;
                    </span><span class="style5">break</span><span class="style10">;
                }
            }
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">ok</span><span class="style10">)
            {
                </span><span class="style5">int </span><span class="style11">m </span><span class="style10">= </span><span class="style11">n </span><span class="style10">- </span><span class="style4">1</span><span class="style10">;
                </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i</span><span class="style10">++)
                {
                    </span><span class="style11">edge </span><span class="style10">&amp;</span><span class="style11">e </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]];
                    </span><span class="style5">if </span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">cap </span><span class="style10">&gt; </span><span class="style11">e</span><span class="style10">.</span><span class="style11">flow</span><span class="style10">)
                    {
                        </span><span class="style11">m </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">m</span><span class="style10">, </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]);
                    }
                }
                </span><span class="style5">if </span><span class="style10">(--</span><span class="style11">num</span><span class="style10">[</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]] == </span><span class="style4">0</span><span class="style10">)
                {
                    </span><span class="style5">break</span><span class="style10">;
                }
                </span><span class="style11">num</span><span class="style10">[</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">m </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">]++;
                </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x </span><span class="style10">!= </span><span class="style11">s</span><span class="style10">)
                {
                    </span><span class="style11">x </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">from</span><span class="style10">;
                }
            }
        }
        </span><span class="style5">return </span><span class="style11">flow</span><span class="style10">;
    }
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; &gt; </span><span class="style11">path</span><span class="style10">(</span><span class="style5">int </span><span class="style11">flow</span><span class="style10">)
    {
        </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; &gt; </span><span class="style11">ans</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">x </span><span class="style10">= </span><span class="style11">s</span><span class="style10">;
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">cur</span><span class="style10">, </span><span class="style4">0</span><span class="style10">, </span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">cur</span><span class="style10">));
        </span><span class="style5">while </span><span class="style10">(</span><span class="style11">flow</span><span class="style10">)
        {
            </span><span class="style5">if </span><span class="style10">(</span><span class="style11">x </span><span class="style10">== </span><span class="style11">t</span><span class="style10">)
            {
                </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt; </span><span class="style11">pt</span><span class="style10">;
                </span><span class="style5">int </span><span class="style11">a </span><span class="style10">= </span><span class="style11">inf</span><span class="style10">;
                </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">!= </span><span class="style11">s</span><span class="style10">)
                {
                    </span><span class="style5">if</span><span class="style10">(!(</span><span class="style11">x </span><span class="style10">&amp; </span><span class="style4">1</span><span class="style10">))
                    </span><span class="style11">pt</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">((</span><span class="style11">x </span><span class="style10">&gt;&gt; </span><span class="style4">1</span><span class="style10">)+</span><span class="style4">1</span><span class="style10">);
                    </span><span class="style11">a </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">a</span><span class="style10">, </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">flow</span><span class="style10">);
                    </span><span class="style11">x </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">from</span><span class="style10">;
                }
                </span><span class="style11">x </span><span class="style10">= </span><span class="style11">t</span><span class="style10">;
                </span><span class="style5">while </span><span class="style10">(</span><span class="style11">x </span><span class="style10">!= </span><span class="style11">s</span><span class="style10">)
                {
                    </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">flow </span><span class="style10">-= </span><span class="style11">a</span><span class="style10">;
                    </span><span class="style11">x </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">from</span><span class="style10">;
                }
                </span><span class="style11">flow </span><span class="style10">-= </span><span class="style11">a</span><span class="style10">;
                </span><span class="style11">pt</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">a</span><span class="style10">);
                </span><span class="style11">ans</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">pt</span><span class="style10">);

            }
            </span><span class="style5">int </span><span class="style11">ok </span><span class="style10">= </span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for </span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">].</span><span class="style16">size</span><span class="style10">(); </span><span class="style11">i</span><span class="style10">++)
            {
                </span><span class="style11">edge </span><span class="style10">&amp; </span><span class="style11">e </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]];
                </span><span class="style5">if </span><span class="style10">(</span><span class="style11">e</span><span class="style10">.</span><span class="style11">flow </span><span class="style10">&gt; </span><span class="style4">0</span><span class="style10">)
                {
                    </span><span class="style11">p</span><span class="style10">[</span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">] = </span><span class="style11">G</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
                    </span><span class="style11">ok </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
                    </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style11">i</span><span class="style10">;
                    </span><span class="style11">x </span><span class="style10">= </span><span class="style11">e</span><span class="style10">.</span><span class="style11">to</span><span class="style10">;
                    </span><span class="style5">break</span><span class="style10">;
                }
            }
            </span><span class="style5">if </span><span class="style10">(!</span><span class="style11">ok</span><span class="style10">)
            {
                </span><span class="style11">cur</span><span class="style10">[</span><span class="style11">x</span><span class="style10">] = </span><span class="style4">0</span><span class="style10">;
                </span><span class="style5">if</span><span class="style10">(</span><span class="style11">x </span><span class="style10">!= </span><span class="style11">s</span><span class="style10">)
                </span><span class="style11">x </span><span class="style10">= </span><span class="style11">es</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">x</span><span class="style10">]].</span><span class="style11">from</span><span class="style10">;
            }
        }
        </span><span class="style5">return </span><span class="style11">ans</span><span class="style10">;
    }
};


</span><span class="style11">最小费用

</span><span class="style9">#include&lt;stdio.h&gt;        </span><span class="style2">//大概这么多头文件昂
</span><span class="style9">#include&lt;string.h&gt;
#include&lt;vector&gt;
#include&lt;queue&gt;
#include&lt;algorithm&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxm</span><span class="style10">=</span><span class="style4">10000</span><span class="style10">+</span><span class="style4">100</span><span class="style10">;    </span><span class="style2">//最大点数
</span><span class="style5">const int </span><span class="style11">INF</span><span class="style10">=</span><span class="style4">0x3f3f3f3f</span><span class="style10">;

</span><span class="style5">struct </span><span class="style11">edge</span><span class="style10">{        </span><span class="style2">//边：起点、终点、容量、流量、单位费用
    </span><span class="style5">int </span><span class="style11">from</span><span class="style10">,</span><span class="style11">to</span><span class="style10">,</span><span class="style11">c</span><span class="style10">,</span><span class="style11">f</span><span class="style10">,</span><span class="style11">cost</span><span class="style10">;
    </span><span class="style11">edge</span><span class="style10">(</span><span class="style5">int </span><span class="style11">a</span><span class="style10">,</span><span class="style5">int </span><span class="style11">b</span><span class="style10">,</span><span class="style5">int </span><span class="style11">m</span><span class="style10">,</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style5">int </span><span class="style11">p</span><span class="style10">):</span><span class="style11">from</span><span class="style10">(</span><span class="style11">a</span><span class="style10">),</span><span class="style11">to</span><span class="style10">(</span><span class="style11">b</span><span class="style10">),</span><span class="style11">c</span><span class="style10">(</span><span class="style11">m</span><span class="style10">),</span><span class="style11">f</span><span class="style10">(</span><span class="style11">n</span><span class="style10">),</span><span class="style11">cost</span><span class="style10">(</span><span class="style11">p</span><span class="style10">){}
};

</span><span class="style5">int </span><span class="style11">aabs</span><span class="style10">(</span><span class="style5">int </span><span class="style11">a</span><span class="style10">){
    </span><span class="style5">return </span><span class="style11">a</span><span class="style10">&gt;=</span><span class="style4">0</span><span class="style10">?</span><span class="style11">a</span><span class="style10">:-</span><span class="style11">a</span><span class="style10">;
}

</span><span class="style5">struct </span><span class="style11">MCMF</span><span class="style10">{
    </span><span class="style5">int </span><span class="style11">m</span><span class="style10">,</span><span class="style11">s</span><span class="style10">,</span><span class="style11">t</span><span class="style10">;
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style11">edge</span><span class="style10">&gt;</span><span class="style11">e</span><span class="style10">;
    </span><span class="style16">vector</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;</span><span class="style11">g</span><span class="style10">[</span><span class="style11">maxm</span><span class="style10">];
    </span><span class="style5">int </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">maxm</span><span class="style10">],</span><span class="style11">a</span><span class="style10">[</span><span class="style11">maxm</span><span class="style10">],</span><span class="style11">p</span><span class="style10">[</span><span class="style11">maxm</span><span class="style10">];
    </span><span class="style5">bool </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">maxm</span><span class="style10">];

    </span><span class="style5">void </span><span class="style11">init</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">){        </span><span class="style2">//初始化函数
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i</span><span class="style10">=</span><span class="style4">0</span><span class="style10">;</span><span class="style11">i</span><span class="style10">&lt;=</span><span class="style11">n</span><span class="style10">;</span><span class="style11">i</span><span class="style10">++)</span><span class="style11">g</span><span class="style10">[</span><span class="style11">i</span><span class="style10">].</span><span class="style16">clear</span><span class="style10">();
        </span><span class="style11">e</span><span class="style10">.</span><span class="style16">clear</span><span class="style10">();
    }

    </span><span class="style5">void </span><span class="style11">add</span><span class="style10">(</span><span class="style5">int </span><span class="style11">a</span><span class="style10">,</span><span class="style5">int </span><span class="style11">b</span><span class="style10">,</span><span class="style5">int </span><span class="style11">c</span><span class="style10">,</span><span class="style5">int </span><span class="style11">v</span><span class="style10">){    </span><span class="style2">//加边函数
        </span><span class="style11">e</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">(</span><span class="style11">a</span><span class="style10">,</span><span class="style11">b</span><span class="style10">,</span><span class="style11">c</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,</span><span class="style11">v</span><span class="style10">));
        </span><span class="style11">e</span><span class="style10">.</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">edge</span><span class="style10">(</span><span class="style11">b</span><span class="style10">,</span><span class="style11">a</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,-</span><span class="style11">v</span><span class="style10">));
        </span><span class="style11">m</span><span class="style10">=</span><span class="style11">e</span><span class="style10">.</span><span class="style16">size</span><span class="style10">();
        </span><span class="style11">g</span><span class="style10">[</span><span class="style11">a</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">m</span><span class="style10">-</span><span class="style4">2</span><span class="style10">);
        </span><span class="style11">g</span><span class="style10">[</span><span class="style11">b</span><span class="style10">].</span><span class="style16">push_back</span><span class="style10">(</span><span class="style11">m</span><span class="style10">-</span><span class="style4">1</span><span class="style10">);
    }

    </span><span class="style5">bool </span><span class="style11">spfa</span><span class="style10">(</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">flow</span><span class="style10">,</span><span class="style5">int</span><span class="style10">&amp; </span><span class="style11">cost</span><span class="style10">){
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">dis</span><span class="style10">,</span><span class="style4">0x3f</span><span class="style10">,</span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">dis</span><span class="style10">));
        </span><span class="style11">memset</span><span class="style10">(</span><span class="style11">vis</span><span class="style10">,</span><span class="style4">0</span><span class="style10">,</span><span class="style5">sizeof</span><span class="style10">(</span><span class="style11">vis</span><span class="style10">));
        </span><span class="style16">queue</span><span class="style10">&lt;</span><span class="style5">int</span><span class="style10">&gt;</span><span class="style11">q</span><span class="style10">;
        </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">s</span><span class="style10">);
        </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">s</span><span class="style10">]=</span><span class="style4">1</span><span class="style10">;
        </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">s</span><span class="style10">]=</span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">p</span><span class="style10">[</span><span class="style11">s</span><span class="style10">]=</span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">a</span><span class="style10">[</span><span class="style11">s</span><span class="style10">]=</span><span class="style11">INF</span><span class="style10">;
        </span><span class="style5">while</span><span class="style10">(!</span><span class="style11">q</span><span class="style10">.</span><span class="style16">empty</span><span class="style10">()){
            </span><span class="style5">int </span><span class="style11">u</span><span class="style10">=</span><span class="style11">q</span><span class="style10">.</span><span class="style16">front</span><span class="style10">();</span><span class="style11">q</span><span class="style10">.</span><span class="style11">pop</span><span class="style10">();
            </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]=</span><span class="style4">0</span><span class="style10">;
            </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i</span><span class="style10">=</span><span class="style4">0</span><span class="style10">;</span><span class="style11">i</span><span class="style10">&lt;</span><span class="style11">g</span><span class="style10">[</span><span class="style11">u</span><span class="style10">].</span><span class="style16">size</span><span class="style10">();</span><span class="style11">i</span><span class="style10">++){
                </span><span class="style11">edge tmp</span><span class="style10">=</span><span class="style11">e</span><span class="style10">[</span><span class="style11">g</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">]];
                </span><span class="style5">if</span><span class="style10">(</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]&gt;</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]+</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">cost</span><span class="style10">&amp;&amp;</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">c</span><span class="style10">&gt;</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">f</span><span class="style10">){
                    </span><span class="style11">dis</span><span class="style10">[</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]=</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]+</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">cost</span><span class="style10">;
                    </span><span class="style11">p</span><span class="style10">[</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]=</span><span class="style11">g</span><span class="style10">[</span><span class="style11">u</span><span class="style10">][</span><span class="style11">i</span><span class="style10">];
                    </span><span class="style11">a</span><span class="style10">[</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]=</span><span class="style16">min</span><span class="style10">(</span><span class="style11">a</span><span class="style10">[</span><span class="style11">u</span><span class="style10">],</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">c</span><span class="style10">-</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">f</span><span class="style10">);
                    </span><span class="style5">if</span><span class="style10">(!</span><span class="style11">vis</span><span class="style10">[</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]){
                        </span><span class="style11">q</span><span class="style10">.</span><span class="style11">push</span><span class="style10">(</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">);
                        </span><span class="style11">vis</span><span class="style10">[</span><span class="style11">tmp</span><span class="style10">.</span><span class="style11">to</span><span class="style10">]=</span><span class="style4">1</span><span class="style10">;
                    }
                }
            }
        }
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">t</span><span class="style10">]==</span><span class="style11">INF</span><span class="style10">)</span><span class="style5">return </span><span class="style4">0</span><span class="style10">;
        </span><span class="style11">flow</span><span class="style10">+=</span><span class="style11">a</span><span class="style10">[</span><span class="style11">t</span><span class="style10">];
        </span><span class="style11">cost</span><span class="style10">+=</span><span class="style11">dis</span><span class="style10">[</span><span class="style11">t</span><span class="style10">]*</span><span class="style11">a</span><span class="style10">[</span><span class="style11">t</span><span class="style10">];
        </span><span class="style5">int </span><span class="style11">u</span><span class="style10">=</span><span class="style11">t</span><span class="style10">;
        </span><span class="style5">while</span><span class="style10">(</span><span class="style11">u</span><span class="style10">!=</span><span class="style11">s</span><span class="style10">){
            </span><span class="style11">e</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]].</span><span class="style11">f</span><span class="style10">+=</span><span class="style11">a</span><span class="style10">[</span><span class="style11">t</span><span class="style10">];
            </span><span class="style11">e</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]^</span><span class="style4">1</span><span class="style10">].</span><span class="style11">f</span><span class="style10">-=</span><span class="style11">a</span><span class="style10">[</span><span class="style11">t</span><span class="style10">];
            </span><span class="style11">u</span><span class="style10">=</span><span class="style11">e</span><span class="style10">[</span><span class="style11">p</span><span class="style10">[</span><span class="style11">u</span><span class="style10">]].</span><span class="style11">from</span><span class="style10">;
        }
        </span><span class="style5">return </span><span class="style4">1</span><span class="style10">;
    }

    </span><span class="style5">int </span><span class="style11">MF</span><span class="style10">(</span><span class="style5">int </span><span class="style11">s</span><span class="style10">,</span><span class="style5">int </span><span class="style11">t</span><span class="style10">){
        </span><span class="style5">this</span><span class="style10">-&gt;</span><span class="style11">s</span><span class="style10">=</span><span class="style11">s</span><span class="style10">;</span><span class="style5">this</span><span class="style10">-&gt;</span><span class="style11">t</span><span class="style10">=</span><span class="style11">t</span><span class="style10">;
        </span><span class="style5">int </span><span class="style11">flow</span><span class="style10">=</span><span class="style4">0</span><span class="style10">,</span><span class="style11">cost</span><span class="style10">=</span><span class="style4">0</span><span class="style10">;
        </span><span class="style5">while</span><span class="style10">(</span><span class="style11">spfa</span><span class="style10">(</span><span class="style11">flow</span><span class="style10">,</span><span class="style11">cost</span><span class="style10">));
        </span><span class="style5">return </span><span class="style11">cost</span><span class="style10">;
    }

};

</span><span class="style11">rmq
</span><span class="style2">//sparse table version

</span><span class="style9">#include&lt;algorithm&gt;
#include&lt;cstdio&gt;
</span><span class="style5">using namespace </span><span class="style16">std</span><span class="style10">;

</span><span class="style5">const int </span><span class="style11">MAXN </span><span class="style10">= </span><span class="style4">50010</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">][</span><span class="style4">20</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">][</span><span class="style4">20</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">];
</span><span class="style2">//初始化RMQ, b数组下标从1开始，从0开始简单修改
</span><span class="style5">void </span><span class="style11">initRMQ</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style5">int </span><span class="style11">b</span><span class="style10">[])
{
    </span><span class="style11">mm</span><span class="style10">[</span><span class="style4">0</span><span class="style10">] = -</span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
    {
        </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">i</span><span class="style10">] = ((</span><span class="style11">i</span><span class="style10">&amp;(</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">)) == </span><span class="style4">0</span><span class="style10">)?</span><span class="style11">mm</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]+</span><span class="style4">1</span><span class="style10">:</span><span class="style11">mm</span><span class="style10">[</span><span class="style11">i</span><span class="style10">-</span><span class="style4">1</span><span class="style10">];
        </span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style4">0</span><span class="style10">] = </span><span class="style11">b</span><span class="style10">[</span><span class="style11">i</span><span class="style10">];

    }
    </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">j </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">j </span><span class="style10">&lt;= </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">n</span><span class="style10">]; </span><span class="style11">j</span><span class="style10">++)
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">1</span><span class="style10">; </span><span class="style11">i </span><span class="style10">+ (</span><span class="style4">1</span><span class="style10">&lt;&lt;</span><span class="style11">j</span><span class="style10">) -</span><span class="style4">1 </span><span class="style10">&lt;= </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
            {
                </span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">],</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+(</span><span class="style4">1</span><span class="style10">&lt;&lt;(</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
                </span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">],</span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">i</span><span class="style10">+(</span><span class="style4">1</span><span class="style10">&lt;&lt;(</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">))][</span><span class="style11">j</span><span class="style10">-</span><span class="style4">1</span><span class="style10">]);
            }
}
</span><span class="style2">//查询最大值,x y inclusive&gt;?
</span><span class="style5">int </span><span class="style11">rmq</span><span class="style10">(</span><span class="style5">int </span><span class="style11">x</span><span class="style10">,</span><span class="style5">int </span><span class="style11">y</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">k </span><span class="style10">= </span><span class="style11">mm</span><span class="style10">[</span><span class="style11">y</span><span class="style10">-</span><span class="style11">x</span><span class="style10">+</span><span class="style4">1</span><span class="style10">];
    </span><span class="style5">return </span><span class="style16">max</span><span class="style10">(</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">k</span><span class="style10">],</span><span class="style11">dp</span><span class="style10">[</span><span class="style11">y</span><span class="style10">-(</span><span class="style4">1</span><span class="style10">&lt;&lt;</span><span class="style11">k</span><span class="style10">)+</span><span class="style4">1</span><span class="style10">][</span><span class="style11">k</span><span class="style10">]) - </span><span class="style16">min</span><span class="style10">(</span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">x</span><span class="style10">][</span><span class="style11">k</span><span class="style10">],</span><span class="style11">dp2</span><span class="style10">[</span><span class="style11">y</span><span class="style10">-(</span><span class="style4">1</span><span class="style10">&lt;&lt;</span><span class="style11">k</span><span class="style10">)+</span><span class="style4">1</span><span class="style10">][</span><span class="style11">k</span><span class="style10">]);
}

</span><span class="style5">int </span><span class="style11">a</span><span class="style10">[</span><span class="style11">MAXN</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">main</span><span class="style10">()
{
    </span><span class="style5">int </span><span class="style11">n</span><span class="style10">,</span><span class="style11">m</span><span class="style10">,</span><span class="style11">x</span><span class="style10">,</span><span class="style11">y</span><span class="style10">;
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d%d"</span><span class="style10">,&amp;</span><span class="style11">n</span><span class="style10">,&amp;</span><span class="style11">m</span><span class="style10">)!=</span><span class="style11">EOF</span><span class="style10">)
    {
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d"</span><span class="style10">,</span><span class="style11">a </span><span class="style10">+</span><span class="style11">i</span><span class="style10">);
        }
        </span><span class="style11">initRMQ</span><span class="style10">(</span><span class="style11">n</span><span class="style10">, </span><span class="style11">a </span><span class="style10">- </span><span class="style4">1</span><span class="style10">);
        </span><span class="style5">for</span><span class="style10">(</span><span class="style5">int </span><span class="style11">i </span><span class="style10">= </span><span class="style4">0</span><span class="style10">; </span><span class="style11">i </span><span class="style10">&lt; </span><span class="style11">m</span><span class="style10">; </span><span class="style11">i</span><span class="style10">++)
        {
            </span><span class="style11">scanf</span><span class="style10">(</span><span class="style6">"%d%d"</span><span class="style10">, &amp;</span><span class="style11">x</span><span class="style10">,&amp;</span><span class="style11">y</span><span class="style10">);
            </span><span class="style11">printf</span><span class="style10">(</span><span class="style6">"%d\n"</span><span class="style10">,</span><span class="style11">rmq</span><span class="style10">(</span><span class="style11">x</span><span class="style10">,</span><span class="style11">y</span><span class="style10">));
        }
    }
}


</span><span class="style11">线段树，点修改</span><span class="style10">/</span><span class="style11">段修改，离线部分不完整
</span><span class="style5">const int </span><span class="style11">inf </span><span class="style10">= </span><span class="style4">0x3f3f3f3f</span><span class="style10">;
</span><span class="style5">const int </span><span class="style11">maxn </span><span class="style10">= </span><span class="style4">100000 </span><span class="style10">+ </span><span class="style4">10</span><span class="style10">;
</span><span class="style5">int </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">maxn</span><span class="style10">];
</span><span class="style5">int </span><span class="style11">v0</span><span class="style10">;
</span><span class="style5">int </span><span class="style10">* </span><span class="style11">pv</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">init</span><span class="style10">(</span><span class="style5">int </span><span class="style11">n</span><span class="style10">)
{
    </span><span class="style11">v0 </span><span class="style10">= </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">while</span><span class="style10">(</span><span class="style11">v0 </span><span class="style10">&lt; </span><span class="style11">n</span><span class="style10">)
    {
        </span><span class="style11">v0 </span><span class="style10">&lt;&lt;= </span><span class="style4">1</span><span class="style10">;
    }
    </span><span class="style11">pv </span><span class="style10">= </span><span class="style11">minv </span><span class="style10">+ </span><span class="style11">v0</span><span class="style10">;
}

</span><span class="style2">//l, r, ql, qr ,all inclusive
</span><span class="style5">int </span><span class="style11">query</span><span class="style10">(</span><span class="style5">int </span><span class="style11">o</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">ql</span><span class="style10">, </span><span class="style5">int </span><span class="style11">qr</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= </span><span class="style11">l </span><span class="style10">+ (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">) / </span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">ans </span><span class="style10">= </span><span class="style11">inf</span><span class="style10">;
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">ql </span><span class="style10">&lt;= </span><span class="style11">l </span><span class="style10">&amp;&amp; </span><span class="style11">r </span><span class="style10">&lt;= </span><span class="style11">qr</span><span class="style10">)
    {
        </span><span class="style5">return </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">];
    }
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">ql </span><span class="style10">&lt;= </span><span class="style11">mid</span><span class="style10">)
    {
        </span><span class="style11">ans </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">ans</span><span class="style10">, </span><span class="style11">query</span><span class="style10">(</span><span class="style11">o </span><span class="style10">&lt;&lt; </span><span class="style4">1</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">ql</span><span class="style10">, </span><span class="style11">qr</span><span class="style10">));
    }
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">M </span><span class="style10">&lt; </span><span class="style11">qr</span><span class="style10">)
    {
        </span><span class="style11">ans </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">ans</span><span class="style10">, </span><span class="style11">query</span><span class="style10">(</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">ql</span><span class="style10">, </span><span class="style11">qr</span><span class="style10">));
    }
    </span><span class="style5">return </span><span class="style11">ans</span><span class="style10">;
}
</span><span class="style2">//Point update; l, r inclusive
</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">o</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">p</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">);
{
    </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= </span><span class="style11">l </span><span class="style10">+ (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">)/</span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">l </span><span class="style10">== </span><span class="style11">r</span><span class="style10">)
    {
        </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] = </span><span class="style11">v</span><span class="style10">;
    }
    </span><span class="style5">else
    </span><span class="style10">{
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">p </span><span class="style10">&lt;= </span><span class="style11">mid</span><span class="style10">)
        {
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">p</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style5">else
        </span><span class="style10">{
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">p</span><span class="style10">, </span><span class="style11">v</span><span class="style10">);
        }
        </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">], </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2</span><span class="style10">]);
    }
}

</span><span class="style5">void </span><span class="style11">maintain</span><span class="style10">(</span><span class="style5">int </span><span class="style11">o</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">lc </span><span class="style10">= </span><span class="style11">o </span><span class="style10">* </span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">rc </span><span class="style10">= </span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
   </span><span class="style2">// sumv[o] = minv[lc] = maxv[o] = 0;
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">r </span><span class="style10">&gt; </span><span class="style11">l</span><span class="style10">)
    {
        </span><span class="style11">sumv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] = </span><span class="style11">sumv</span><span class="style10">[</span><span class="style11">lc</span><span class="style10">] + </span><span class="style11">sumv</span><span class="style10">[</span><span class="style11">rc</span><span class="style10">];
        </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] = </span><span class="style16">min</span><span class="style10">(</span><span class="style11">minv</span><span class="style10">[</span><span class="style11">lc</span><span class="style10">], </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">rc</span><span class="style10">]);
        </span><span class="style11">maxv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] = </span><span class="style16">max</span><span class="style10">(</span><span class="style11">maxv</span><span class="style10">[</span><span class="style11">lc</span><span class="style10">], </span><span class="style11">maxv</span><span class="style10">[</span><span class="style11">rc</span><span class="style10">]);
    }
    </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] += </span><span class="style11">addv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">];
    </span><span class="style11">maxv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] += </span><span class="style11">addv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">];
    </span><span class="style11">sumv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] += </span><span class="style11">addv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] * (</span><span class="style11">R </span><span class="style10">- </span><span class="style11">L </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">);
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">o</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">v</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">lc </span><span class="style10">= </span><span class="style11">o </span><span class="style10">* </span><span class="style4">2</span><span class="style10">;
    </span><span class="style5">int </span><span class="style11">rc </span><span class="style10">= </span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">y1 </span><span class="style10">&lt;= </span><span class="style11">l </span><span class="style10">&amp;&amp; </span><span class="style11">y2 </span><span class="style10">&gt;= </span><span class="style11">r</span><span class="style10">)
    {
        </span><span class="style11">add</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] += </span><span class="style11">v</span><span class="style10">;
    }
    </span><span class="style5">else
    </span><span class="style10">{
        </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= </span><span class="style11">l </span><span class="style10">+(</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">) / </span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">if</span><span class="style10">( </span><span class="style11">y1 </span><span class="style10">&lt;= </span><span class="style11">mid</span><span class="style10">)
        {
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">lc</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">);
        }
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">y2 </span><span class="style10">&gt; </span><span class="style11">mid</span><span class="style10">)
        {
            </span><span class="style11">update</span><span class="style10">(</span><span class="style11">rc</span><span class="style10">, </span><span class="style11">mid </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
        }
        </span><span class="style11">maintain</span><span class="style10">(</span><span class="style11">o</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">r</span><span class="style10">);
    }
}
</span><span class="style5">int </span><span class="style11">_min</span><span class="style10">, </span><span class="style11">_max</span><span class="style10">, </span><span class="style11">_sum</span><span class="style10">;
</span><span class="style5">void </span><span class="style11">query</span><span class="style10">(</span><span class="style5">int </span><span class="style11">o</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">, </span><span class="style5">int </span><span class="style11">add</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y1</span><span class="style10">, </span><span class="style5">int </span><span class="style11">y2</span><span class="style10">)
{
    </span><span class="style5">if</span><span class="style10">(</span><span class="style11">y1 </span><span class="style10">&lt;= </span><span class="style11">l </span><span class="style10">&amp;&amp; </span><span class="style11">y2 </span><span class="style10">&gt;= </span><span class="style11">r</span><span class="style10">)
    {
        </span><span class="style11">_sum </span><span class="style10">+= </span><span class="style11">sumv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] + </span><span class="style11">add </span><span class="style10">* (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">);
        </span><span class="style11">_min </span><span class="style10">= </span><span class="style16">min</span><span class="style10">(</span><span class="style11">_min</span><span class="style10">, </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] + </span><span class="style11">add</span><span class="style10">);
        </span><span class="style11">_max </span><span class="style10">= </span><span class="style16">max</span><span class="style10">(</span><span class="style11">_max</span><span class="style10">, </span><span class="style11">minv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">] + </span><span class="style11">add</span><span class="style10">);
    }
    </span><span class="style5">else
    </span><span class="style10">{
        </span><span class="style5">int </span><span class="style11">mid </span><span class="style10">= </span><span class="style11">l </span><span class="style10">+ (</span><span class="style11">r </span><span class="style10">- </span><span class="style11">l</span><span class="style10">) / </span><span class="style4">2</span><span class="style10">;
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">y1 </span><span class="style10">&lt;= </span><span class="style11">mid</span><span class="style10">)
        {
            </span><span class="style11">query</span><span class="style10">(</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2</span><span class="style10">, </span><span class="style11">l</span><span class="style10">, </span><span class="style11">mid</span><span class="style10">, </span><span class="style11">add </span><span class="style10">+ </span><span class="style11">addv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">], </span><span class="style11">y1</span><span class="style10">, </span><span class="style11">y2</span><span class="style10">);
        }
        </span><span class="style5">if</span><span class="style10">(</span><span class="style11">y2 </span><span class="style10">&gt; </span><span class="style11">mid</span><span class="style10">)
        {
            </span><span class="style11">query</span><span class="style10">(</span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">mid </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">, </span><span class="style11">r</span><span class="style10">, </span><span class="style11">add </span><span class="style10">+ </span><span class="style11">addv</span><span class="style10">[</span><span class="style11">o</span><span class="style10">], </span><span class="style11">y1</span><span class="style10">, </span><span class="style11">y2</span><span class="style10">);
        }
    }
}

</span><span class="style5">void </span><span class="style11">update</span><span class="style10">(</span><span class="style5">int </span><span class="style11">o</span><span class="style10">, </span><span class="style5">int </span><span class="style11">l</span><span class="style10">, </span><span class="style5">int </span><span class="style11">r</span><span class="style10">)
{
    </span><span class="style5">int </span><span class="style11">lc </span><span class="style10">= </span><span class="style11">o </span><span class="style10">* </span><span class="style4">2</span><span class="style10">, </span><span class="style11">rc </span><span class="style10">= </span><span class="style11">o </span><span class="style10">* </span><span class="style4">2 </span><span class="style10">+ </span><span class="style4">1</span><span class="style10">;
    </span><span class="style5">if</span><span class="style10">()
}


</span></span>
</code></pre>
</body>
</html>
